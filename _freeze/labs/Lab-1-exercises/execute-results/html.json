{
  "hash": "fea59f432705ce9af80d6c402856ffef",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Stata Lab 1: Exercises\"\nauthor: Jonathan Jayes\ndate: today\nformat:\n  html:\n    code-overflow: wrap\n  pdf:\n    documentclass: scrreprt\n    toc: true\nexecute: \n  eval: false\n  echo: true\nimage: \"Lab-1-resources/preview_exercises.png\"\n---\n\n\n\n\n## Purpose\n\n📈 Stata is a powerful software for data analysis and visualization. This exercise set aims to showcase the capabilities of Stata in creating informative graphics 📊. We will be using data on the UK and Sweden 🇬🇧🇸🇪 to demonstrate the process of making a map 🗺️, a combined plot 📈, and a summary table 📊. The purpose of this accompanying post is to provide a step-by-step guide 💡 on how to use Stata's built-in tools 🛠️ to create effective visualizations 🎨 that help communicate insights from your data 🙌.\n\n## Get started\n\nAs before, we want to load our data from the `regional_dataset.dta` file.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncd \"C:/Users/User/Documents/Recon/EOSE09/stata_files/\" # set your directory\nuse regional_dataset, clear\n\nformat regional_gdp_cap_1990 %12.0fc # 12 numbers left of the decimal point; 0 to the right; commas to denote thousands\n```\n:::\n\n\n\n\n### Question 1\n\n•\tMap of GDP per capita in Sweden and the United Kingdom in 1990\n\nThere are two ways to do this.\n\n#### Method 1: use their locations on a map\n\nFirst we create a variable for if the country is Sweden or the UK.\n\nThen we use this vairable to create the map with an `if` statement.\n\nNote that you need to change your breaks in order to display the full range of data.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngen uk_sv = .\nreplace uk_sv = 1 if country == \"Sweden\" | country == \"United Kingdom\"\n\nspmap regional_gdp_cap_1990 using \"nutscoord.dta\" if year == 1990 & uk_sv == 1, id(_ID) fcolor(Blues2) legend(pos(9)) legstyle(2) \n\ttitle(\"Regional GDP per Capita - 1990\", size(medium)) \n\tclmethod(custom) clbreaks(0 12000 15000 16000 17000 18000 21000)\n```\n:::\n\n\n\n\n![](Lab-1-resources/exercises_1.PNG)\n\n#### Method 2: graph combine\n\nHere we make two graphs with the same scale, but only the graph for Sweden includes a legend.\n\nThe UK map has the legend suppressed with the `leg(off)` command.\n\nThen we name each, and combine it with a title in the final step.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspmap regional_gdp_cap_1990 using \"nutscoord.dta\" if year == 1990 & country == \"United Kingdom\", id(_ID) fcolor(Blues2) ///\n\ttitle(\"United Kingdom\", size(medium)) ///\n\tname(UK_GDP_1990, replace) ///\n\tleg(off)\n\t\nspmap regional_gdp_cap_1990 using \"nutscoord.dta\" if year == 1990 & country == \"Sweden\", id(_ID) fcolor(Blues2) legend(pos(10)) legstyle(2) ///\n\ttitle(\"Sweden\", size(medium)) ///\n\tclmethod(custom) clbreaks(0 12000 15000 16000 17000 18000 22000) ///\n\tname(SV_GDP_1990, replace)\n\t\ngraph combine UK_GDP_1990 SV_GDP_1990, graphregion(color(white)) ///\n\ttitle(\"Regional GDP per Capita - 1990\") ///\n\tnote(Source: Rosés-Wolf (2020), size(small) position(5)) ///\n\tscheme(s2mono)\n```\n:::\n\n\n\n\n![](Lab-1-resources/exercises_2.PNG)\n\n### Question 2\n\n•\tMap of share of employment in industry in 2010 across the whole dataset\n\nFirst we must ask where the cutoffs should be in the legend.\n\nWe can draw a density plot to find out.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkdensity employment_share_industry if year == 2010\n```\n:::\n\n\n\n\n![](Lab-1-resources/exercises_3.PNG)\n\nNext we use this information to create breaks between 10 percent and 40 percent, where the bulk of the distribution is.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspmap employment_share_industry using \"nutscoord.dta\" if year == 2010, id(_ID) fcolor(Greens) legstyle(2) ///\n\ttitle(\"Employment Share Industry - 2010\", size(large)) ///\n\tosize(0.02 ..) ocolor(white ..) ///\n\tclmethod(custom) clbreaks(0 (0.1) 0.5) ///\n\tlegend(pos(9) size(medium) rowgap(1.5) label(6 \"40-50 %\") label(5 \"30-40 %\") ///\n\tlabel(4 \"20-30 %\") label(3 \"10-20 %\") label(2 \"0-10 %\") label(1 \"No Data\")) ///\n\tndfcolor(gray) ndocolor(white ..) ndsize(0.02 ..)\n```\n:::\n\n\n\n\n![](Lab-1-resources/exercises_4.PNG)\n\n### Question 3\n\n•\tMap of share of employment in services in 1950 in Scandinavia\n\nGenerate variable for Scandnavian countries\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngen scandinavia = .\nreplace scandinavia = 1 if country == \"Sweden\" | country == \"Denmark\" | country == \"Norway\"\n```\n:::\n\n\n\n\nCheck where the weight of the distribution is\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkdensity employment_share_services if year == 1950 & scandinavia == 1\n```\n:::\n\n\n\n\n![](Lab-1-resources/exercises_5.PNG)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspmap employment_share_services using \"nutscoord.dta\" if year == 1950 & scandinavia == 1, id(_ID) fcolor(Reds) legstyle(2) ///\n\ttitle(\"Employment Share Services - 1950\", size(large)) ///\n\tosize(0.02 ..) ocolor(white ..) ///\n\tclmethod(custom) clbreaks(0 (0.1) .7) ///\n\tlegend(pos(9) size(medium) rowgap(1.5) label(8 \"60-70 %\") label(7 \"50-60 %\") ///\n\tlabel(6 \"40-50 %\") label(5 \"30-40 %\") ///\n\tlabel(4 \"20-30 %\") label(3 \"10-20 %\") label(2 \"0-10 %\") label(1 \"No Data\")) ///\n\tndfcolor(gray) ndocolor(white ..) ndsize(0.02 ..)\n```\n:::\n\n\n\n\n\n![](Lab-1-resources/exercises_6.PNG)\n\n### Question 4\n\nScatterplot of GDP per capita in 1990 dollars on the x-axis and share of \nemployment in services on the y-axis for the year 2015. Make the colour of the \npoints on the scatter plot show what country it is.\n\nHere we need an additional package to help us.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nssc install sepscatter\n```\n:::\n\n\n\n\nBasic scatter plot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsepscatter regional_gdp_cap_1990 employment_share_services if year == 2015, separate(country)\n```\n:::\n\n\n\n\n![](Lab-1-resources/exercises_7.PNG)\n\nAdd in linear regression line\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsepscatter regional_gdp_cap_1990 employment_share_services if year == 2015, separate(country) addplot(lfit regional_gdp_cap_1990 employment_share_services if regional_gdp_cap_1990 > 0.5)\n```\n:::\n\n\n\n\n![](Lab-1-resources/exercises_8.PNG)\n\n\n### Question 5\n\n•\tMake a table of the mean GDP per capita by country in 2000. Export it with the Outreg2 command.\n\nRemember how we made a national GDP per capita variable\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbysort country year: egen national_gdp_1990 = total(regional_gdp_1990)\nbysort country year: egen national_population = total(regional_population)\ngen national_gdp_cap_1990 = national_gdp_1990 / national_population\n```\n:::\n\n\n\n\nNow format this number\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformat national_gdp_cap_1990 %12.0fc # 12 numbers left of the decimal point; 0 to the right; commas to denote thousands\n```\n:::\n\n\n\n\nWe could do this with Outreg2. We can also just keep the data that we want, and export it as a csv file. This is quick and dirty, but it works.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkeep country national_gdp_cap_1990 year\n\nkeep if year == 2000\n\nduplicates drop\n\nexport delimited using national_gdp_cap_1990.csv, replace \n```\n:::\n\n\n\n\nOpen this file in excel\nGo to the data tab, select text to columns, delimited, comma, and then format it.\n\nWe can make a nice little bar graph with in Excel too.\n\n![](Lab-1-resources/delimited_output.PNG)\n\n\n",
    "supporting": [
      "Lab-1-exercises_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}